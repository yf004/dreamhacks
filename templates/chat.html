<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Bungee&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono&display=swap" rel="stylesheet">
    <title>chatbot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='chat.css') }}">
</head>
<body>
    <div class="page-container">
        <div class="navbar-column">
            <div class="logo-container">
                <div class="logo">BLOOPI</div>
            </div>
            <div class="nav-container">
                <div id='nav-home' class="nav-item">Home</div>
                <div id='nav-journal' class="nav-item">Journal</div>
                <div id='nav-chat' class="nav-item">Chatbot</div>
            </div>
            <div id="logout">Logout</div>
        </div>
        
        <div class="main-content">
            <div class="main-container">
                <div class="chat-rectangle">
                    <div class="chat-header">
                        <div class="chat-title">Chat Assistant</div>
                        <div class="chat-header-right">
                            <div class="mode-toggle">
                                <span class="mode-label">Creative Mode</span>
                                <div class="toggle-switch" id="modeToggle">
                                    <div class="toggle-slider"></div>
                                </div>
                                <span class="mode-label">Analytical Mode</span>
                            </div>
                            <button class="new-chat-button" id="newChatButton">
                                âœ¨ New Chat
                            </button>
                        </div>
                    </div>
                    
                    <div class="messages-area" id="messagesArea">
                        <!-- Messages will appear here -->
                    </div>
                    
                    <div class="input-container">
                        <textarea
                            class="input-box"
                            id="messageInput"
                            placeholder="Ask me anything"
                            rows="1"
                        ></textarea>
                        <button class="send-button" id="sendButton">
                            <div class="send-icon">
                                <img src="../static/images/send.png" alt="Send">
                            </div>
                        </button>
                    </div>
                </div>
                
                <button class="back-button">Back</button>
            </div>
        </div>
    </div>
    
    <script>
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const messagesArea = document.getElementById('messagesArea');

        // Set initial height for the textarea
        messageInput.style.height = '3.75rem'; // Initial size for one line

        // Auto-resize textarea with maximum height limit
        messageInput.addEventListener('input', function() {
        // Reset height to auto first to get accurate scroll height
        this.style.height = '3.75rem'; // Start with single line height
        
        // Only grow if content exceeds current height
        if (this.scrollHeight > this.clientHeight) {
            // Calculate new height with a maximum limit (4 lines approximately)
            const newHeight = Math.min(this.scrollHeight, 120);
        
            // Apply the new height in pixels for smoother transition
            this.style.height = newHeight + 'px';
        }
        });

        // Send message function
        function sendMessage() {
        const message = messageInput.value.trim();
        if (message) {
            // Create user message bubble
            const userMessageBubble = document.createElement('div');
            userMessageBubble.className = 'message-bubble user-message';
            userMessageBubble.textContent = message;
        
            // Add to messages area
            messagesArea.appendChild(userMessageBubble);
        
            // Clear input and reset height
            messageInput.value = '';
            messageInput.style.height = '3.75rem';
        
            // Add AI response (after a small delay to simulate thinking)
            setTimeout(() => {
            // Create AI message bubble
            const aiMessageBubble = document.createElement('div');
            aiMessageBubble.className = 'message-bubble ai-message';
            aiMessageBubble.textContent = "[Insert AI response]";
        
            // Add to messages area
            messagesArea.appendChild(aiMessageBubble);
        
            // Scroll messages to bottom
            messagesArea.scrollTop = messagesArea.scrollHeight;
            }, 500);
            
            // Scroll messages to bottom after user message
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }
        }

        // Send button click
        sendButton.addEventListener('click', sendMessage);

        // Enter key to send (Shift+Enter for new line)
        messageInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMessage();
        }
        });

        // Back button functionality
        document.querySelector('.back-button').addEventListener('click', function() {
        // You can add navigation logic here
        console.log('Back button clicked');
        });

        //toggle button
        document.getElementById('modeToggle').addEventListener('click', function() {
                    this.classList.toggle('active');
        });

         // New chat button functionality
        document.getElementById('newChatButton').addEventListener('click', function() {
            // Clear all messages
            const messagesArea = document.getElementById('messagesArea');
            messagesArea.innerHTML = '';
        });
    </script>
</body>
</html>
